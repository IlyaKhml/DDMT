<!-- (Automatically translated via ChatGPT.) -->

<p align='center'>
    <a href='..\ru\settings.md'>RU</a> • <a href='..\en\settings.md'>EN</a> • <b>ZH</b>
</p>
<p align='center'>
    <a href='README.md'>主页</a> • 
    <b>文件</b> • <a href='how_it_works.md'>它是如何工作的？</a> • <a href='qa.md'>问题</a>
</p>

# 设置

| 键名                                | 值类型            | 描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | 示例值                                                               |
| ----------------------------------- | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------- |
| `'target_languages'`                | `List(str)`       | 要翻译修改的目标语言。<br><br>指定**翻译器**支持的语言。                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `['english']`<br>`['russian', 'english', 'schinese']`                            |
| `'mod_folder_path'`                 | `str`             | 要翻译的修改文件夹路径。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `r'G:\SteamLibrary\steamapps\common\DarkestDungeon\mods\2200558948'` |
| `'translate_xml_language_priority'` | `List(str)`       | 选择用于翻译的 `.xml` 文件的优先级（如果存在多个 `.xml` 文件）。<br><br>按顺序搜索语言，首先根据 `.xml` 文件名，然后根据 `.xml` 中 `<language>` 标签的 `id`。<br>一旦找到列表中的语言，即开始翻译。<br><br>如果未找到列表中的语言，则使用第一个可用语言。<br><br>适用于优先选择翻译完整的语言（如果其他语言翻译不完整）。<br><br>指定**游戏**支持的语言。 | `['schinese']`<br>`['schinese', 'english']`                           |
| `'copy_loc2_without_translate'`     | `bool`            | 确定是翻译 `.xml` 文件还是仅复制来自 `LOC2_TRANSLATE_PRIORITY` 的语言的 `.loc2` 文件。<br>如果设置为 `True`，则仅复制。                                                                                                                                                                                                                                                                                                                                         | `True`<br>`False`                                                    |
| `'loc2_translate_priority'`         | `List(str)`       | 选择要复制的 `.loc2` 文件的优先级（列表中靠前的语言优先级更高）。<br><br>选择文件名中包含列表中语言的第一个 `.loc2` 文件。<br><br>简单来说，这是您在无法翻译时希望在游戏中看到的语言列表。<br><br>指定**游戏**支持的语言。                                                                                                             | `['english']`<br>`['english', 'schinese']`                           |
| `'suffix_to_mod_title'`             | `str`             | 翻译后的修改标题后追加的内容。<br><br>如果指定了 `'new_mod_title'`，则忽略此项。                                                                                                                                                                                                                                                                                                                                                                               | `'Translated'`<br>`''`                                               |
| `'new_mod_title'`                   | `str` 或 `False`  | 如果要完全重命名修改，则指定新的修改标题。<br><br>如果设置为 `False`，则添加 `'suffix_to_mod_title'` 的后缀。<br><br>如果指定了值，则忽略 `'suffix_to_mod_title'` 的后缀。                                                                                                                                                                                                                                                                                         | `'ModName Translated'`<br>`False`                                    |
| `'translator'`                      | `str`             | 用于翻译 `.xml` 中字符串的翻译器。<br><br>支持 `OpenAI` 的 API。                                                                                                                                                                                                                                                                                                                                                                                                 | `'GoogleTranslator'`<br>`'DeeplTranslator'`<br>`'OpenAI'`            |
| `'translator_api_key'`              | `str`             | `'translator'` 的 API 密钥。<br><br>`GoogleTranslator` 不使用此项。                                                                                                                                                                                                                                                                                                                                                                                              | *取决于翻译器*                                                       |
| `'translator_mode'`                 | `str`             | 发送到翻译器的字符串拆分模式。详情见“翻译模式”。                                                                                                                                                                                                                                                                                                                                                                                                                 | `'raw'`<br>`'optimal'`<br>`'deepl_mustache'`                         |
| `'translator_source_lang'`          | `str` 或 `False`  | 指定文本的源语言：<br><br>`False` - 使用 `.xml` 文件中的语言。<br><br>`'auto'` - 翻译器自动检测（仅适用于 `GoogleTranslator`）。                                                                                                                                                                                                                                                                                                                                     | `False`<br>`'Auto'`                                                  |
| `'translator_model'`                | `str`             | 请求中指定的翻译模型。<br><br>（当 `'translator'` 为 `OpenAI` 或其他 LLM API 时使用）。                                                                                                                                                                                                                                                                                                                                                                           | `gpt-4o-mini`                                                        |
| `'translator_settings'`             | `dict`            | LLM API 模型或其他提供者的设置。<br><br>设置传递给 `LLMClient.py`，处理方式取决于使用的 API。                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                 |
| `'translator_debug'`                | `bool`            | 启用调试消息。<br><br>（显示发送到翻译器的字符串）。                                                                                                                                                                                                                                                                                                                                                                                                              | `True`<br>`False`                                                    |
| `'translate_comments'`              | `bool`            | 是否翻译 `.xml` 文件中的注释。                                                                                                                                                                                                                                                                                                                                                                                                                                   | `True`<br>`False`                                                    |
| `'force_overwrite_loc2'`            | `bool`            | 是否覆盖 `localization` 文件夹中的所有 `.loc2` 文件。<br><br>`True` - 覆盖所有 `.loc2` 文件。<br>`False` - 仅覆盖翻译语言（`target_languages`）的文件。                                                                                                                                                                                                                                                                                                       | `True`<br>`False`                                                    |
| `'use_language_detector'`           | `bool`            | 是否为发送到翻译器的每个字符串使用语言检测器。<br><br>适用于 `.xml` 文件中语言标签内的字符串包含不同语言（翻译不完整）的情况。<br><br>用于 `GoogleTranslator` 和 `DeeplTranslator`。<br><br>需要 API 密钥才能运行。                                                                                                                                                                                                                                       | `True`<br>`False`                                                    |
| `'language_detector_api_key'`       | `str`             | 语言检测器的 API 密钥。                                                                                                                                                                                                                                                                                                                                                                                                                                           |                                                                      |


# 翻译模式
格式化示例的原始字符串：
1. `{colour_start|guard} Guard {colour_end}`
2. `On Attack: Add 3~6 true Dmg and {colour_start|elaina_purpledawn} steal {colour_end} 25%%Spd from target`

| 模式               | 描述和特点                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 发送到翻译器的文本                                                                                                                              |
| ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------- |
| `'raw'`            | 字符串按原样发送，不做任何更改。                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{colour_start\|guard} Guard {colour_end}`<br><br>`On Attack: Add 3~6 true Dmg and {colour_start\|elaina_purpledawn} steal {colour_end} 25%%Spd from target` |
| `'optimal'`        | 将字符串拆分为“不可翻译结构”之间的部分。<br>翻译后重新组装字符串，保留不可翻译结构。<br><br>适用于可能替换/翻译/忽略我们希望保留原样的字符串部分的翻译器。<br><br>按字符计数是最经济的翻译方法。                                                                                                  | `Guard`<br><br>`On Attack: Add 3~6 true Dmg and`<br><br>`steal`<br><br>`25%%Spd from target`                                                          |
| `'deepl_mustache'` | 将不应翻译的文本部分替换为唯一标识符，然后将字符串发送到翻译器。<br><br>收到翻译后，将标识符替换回原文。<br><br>最初为 DeepL 翻译器添加，因为它支持此类结构（不会翻译这些结构）。<br><br>使用此模式时，确保翻译器不会在响应中扭曲或排除唯一标识符。 | `<m id=1/> Guard <m id=2/>`<br><br>`On Attack: Add 3~6 true Dmg and <m id=1/> steal <m id=2/> 25%%Spd from target`                                  |

# 翻译器
以下是几种翻译器的比较表（经我测试）以及支持语言的表格。

| 翻译器             | 最佳格式化模式                                                                      | 翻译质量和特点                                                                                                                                                                                                                   | 成本                                                                                                                                                              | 需要 API 密钥 |
| ------------------ | ----------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| `GoogleTranslator` | 建议使用 `optimal`。<br><br>`raw` 和 `deepl_mustache` 效果较差。                     | 质量较低，但速度快且免费。<br><br>适合用于玩笑翻译或将蓝色文字替换为其他内容。<br><br>对简单文本效果良好。<br><br>具有自动检测源语言的 `auto` 模式。 | 免费                                                                                                                                                              | ❌ 无需          |
| `DeeplTranslator`  | 建议使用 `deepl_mustache` 或 `optimal`（为提高效率）。                              | 中/高质量。                                                                                                                                                                                                                               | **免费：** 每月 500,000 字符。<br><br>专业订阅，每 1,000,000 字符 $25.00。<br><br>[定价](https://www.deepl.com/en/pro/change-plan#developer) | ✔️ 需要          |
| `DeepSeek-R1`      | 使用适合格式化类型的提示的 `deepl_mustache`。                                       | 高/中质量。                                                                                                                                                                                                                               | *取决于提供者。*                                                                                                                                        | ✔️ 需要          |
| `gpt-4o-mini`      | *取决于提示。* 为获得最佳翻译效果，建议使用 `deepl_mustache`。                      | 高/中质量。                                                                                                                                                                                          | *取决于提供者。*                                                                                                                                        | ✔️ 需要          |
| 其他 LLM           | *取决于提示。*                                                                      | *取决于模型。*<br><br>可在 `LLMClient.py` 中为特定提供者进行配置。                                                                                                                                                       | *取决于提供者。*<br><br>如果有资源和意愿，模型可本地部署以实现免费翻译。                                                  | ❓ *可能需要*     |

| 翻译         | 支持的语言                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `GoogleTranslator` | `['afrikaans', 'albanian', 'amharic', 'arabic', 'armenian', 'assamese', 'aymara', 'azerbaijani', 'bambara', 'basque', 'belarusian', 'bengali', 'bhojpuri', 'bosnian', 'bulgarian', 'catalan', 'cebuano', 'chichewa', 'chinese (simplified)', 'chinese (traditional)', 'corsican', 'croatian', 'czech', 'danish', 'dhivehi', 'dogri', 'dutch', 'english', 'esperanto', 'estonian', 'ewe', 'filipino', 'finnish', 'french', 'frisian', 'galician', 'georgian', 'german', 'greek', 'guarani', 'gujarati', 'haitian creole', 'hausa', 'hawaiian', 'hebrew', 'hindi', 'hmong', 'hungarian', 'icelandic', 'igbo', 'ilocano', 'indonesian', 'irish', 'italian', 'japanese', 'javanese', 'kannada', 'kazakh', 'khmer', 'kinyarwanda', 'konkani', 'korean', 'krio', 'kurdish (kurmanji)', 'kurdish (sorani)', 'kyrgyz', 'lao', 'latin', 'latvian', 'lingala', 'lithuanian', 'luganda', 'luxembourgish', 'macedonian', 'maithili', 'malagasy', 'malay', 'malayalam', 'maltese', 'maori', 'marathi', 'meiteilon (manipuri)', 'mizo', 'mongolian', 'myanmar', 'nepali', 'norwegian', 'odia (oriya)', 'oromo', 'pashto', 'persian', 'polish', 'portuguese', 'punjabi', 'quechua', 'romanian', 'russian', 'samoan', 'sanskrit', 'scots gaelic', 'sepedi', 'serbian', 'sesotho', 'shona', 'sindhi', 'sinhala', 'slovak', 'slovenian', 'somali', 'spanish', 'sundanese', 'swahili', 'swedish', 'tajik', 'tamil', 'tatar', 'telugu', 'thai', 'tigrinya', 'tsonga', 'turkish', 'turkmen', 'twi', 'ukrainian', 'urdu', 'uyghur', 'uzbek', 'vietnamese', 'welsh', 'xhosa', 'yiddish', 'yoruba', 'zulu']` |
| `DeeplTranslator`  | `['bulgarian', 'czech', 'danish', 'german', 'greek', 'english', 'spanish', 'estonian', 'finnish', 'french', 'hungarian', 'indonesian', 'italian', 'japanese', 'lithuanian', 'latvian', 'dutch', 'polish', 'portuguese', 'romanian', 'russian', 'slovak', 'slovenian', 'swedish', 'turkish', 'ukrainian', 'chinese']`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `LLM`              | *取决于型号*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

# 语言检测器

为什么需要语言检测器？  
假设我们有一个部分翻译的修改。在这种情况下，`.xml` 文件可能包含两种或更多语言的字符串（最坏情况下）。

在每次向翻译器发送请求时，我们需要指定源语言和目标语言。如果指定了错误的源语言，翻译器可能无法准确翻译文本。

为了确保使用正确的源语言，我们可以检测发送到翻译器的每个字符串的语言。

对于 `DeeplTranslator`，由于其 API 缺乏自动语言检测模式，这可以显著提高翻译质量。

| 语言检测器                                       | 质量评估                                                                                                                                                                                                                                                     | 成本                                                                                                                                              | 需要 API 密钥 |
| ------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| [detectlanguage.com](https://detectlanguage.com/) | 短字符串可能无法始终正确识别。可能会将日语与中文混淆，或返回不同于英语的其他语言。<br>对于 `DeepL` 来说比没有好，但可能需要额外处理错误识别的语言。 | 免费套餐：<br>每天 1,000 次请求<br>每天 1 MB<br><br>[其他付费计划可用。](https://detectlanguage.com/private/plan_changes/new) | ✔️ 需要          |

# 游戏支持的语言
游戏支持的语言大致列表：

`['brazilian', 'czech', 'english', 'french', 'german', 'italian', 'japanese', 'koreana', 'koreanb', 'polish', 'russian', 'schinese', 'spanish', 'tchinese']`

这可能不是完整的列表，如果您确信游戏支持某种语言，可以尝试使用它。