<p align='center'>
    <b>RU</b> • <a href='../en/settings.md'>EN</a> • <a href='../zh/settings.md'>ZH</a>
</p>
<p align='center'>
    <a href='../../readme.md'>Основное</a> • <b>Документация</b> • <a href='how_it_works.md'>Как это работает?</a> • <a href='qa.md'>Вопросы</a> 
</p>

# Настройки

| Ключ                                | Тип значения      | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Пример значения                                                      |
| ----------------------------------- | ----------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------- |
| `'target_languages'`                | `List(str)`       | Языки, на которые нужно перевести мод.<br><br>Нужно указывать язык, поддерживаемый **переводчиком.**                                                                                                                                                                                                                                                                                                                                                                                                                               | `['russian']`<br>`['russian', 'english']`                            |
| `'mod_folder_path'`                 | `str`             | Путь до папки мода, который нужно перевести                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | `r'G:\SteamLibrary\steamapps\common\DarkestDungeon\mods\2200558948'` |
| `'translate_xml_language_priority'` | `List(str)`       | Приоритет выбора файла `.xml` для перевода (если несколько файлов `.xml`).<br><br>Будет искать языки по порядку, вначале по названию файла `.xml`, потом по `id` тега `<language>` внутри `.xml`.<br>Как только найдёт язык из списка - начнёт первод.,<br><br>Если не было найдено языков из списка - использует первый попавшийся язык.<br><br>Полезно указать приоритетный язык, у которого есть полный перевод всех тегов, если некоторые языки переведены неполностью.<br><br>Нужно указывать язык, поддерживаемый **игрой.** | `['english']`<br>`['schinese', 'english']`                           |
| `'copy_loc2_without_translate'`     | `bool`            | Флаг определяющий нужно ли делать перевод xml или просто скопировать `.loc2` с языком из `LOC2_TRANSLATE_PRIORITY`.<br>Если установлен в `True`, то просто скопирует                                                                                                                                                                                                                                                                                                                                                               | `True`<br>`False`                                                    |
| `'loc2_translate_priority'`         | `List(str)`       | Приоритет выбора файлов `.loc2` для копирования перевода (чем левее в списке, тем выше приоритет).<br><br>Выберет первый попавшийся `.loc2` с наличием языка в названии файла из списка.<br><br>Проще говоря, список языков, которые вы были бы рады видеть в игре, если нет возможности перевести мод.<br><br>Нужно указывать язык, поддерживаемый **игрой.**                                                                                                                                                                     | `['english']`<br>`['english', 'schinese']`                           |
| `'suffix_to_mod_title'`             | `str`             | Что нужно добавить в название переведённого мода.<br><br>Игнорируется если указан `'new_mod_title'`.                                                                                                                                                                                                                                                                                                                                                                                                                               | `'Translated'`<br>`''`                                               |
| `'new_mod_title'`                   | `str` или `False` | Новое название мода, если вы хотите полностью его изменить.<br><br>Если установить в `False`, то добавляем суффикс из `'suffix_to_mod_title'`.<br><br>Если указано значение, то суффикс из `'suffix_to_mod_title'` игнорируется.                                                                                                                                                                                                                                                                                                   | `'ModName Translated'`<br>`False`                                    |
| `'translator'`                      | `str`             | Переводчик, который будет использоваться для перевода строк из `.xml`.<br><br>Поддерживает API от `OpenAI`.                                                                                                                                                                                                                                                                                                                                                                                                                        | `'GoogleTranslator'`<br>`'DeeplTranslator'`<br>`'OpenAI'`            |
| `'translator_api_key'`              | `str`             | Api-ключ для переводчика `'translator'`.<br><br>Для `GoogleTransle` не используется.                                                                                                                                                                                                                                                                                                                                                                                                                                               | *Зависит от переводчика*                                             |
| `'translator_mode'`                 | `str`             | Режим деления строк для подачи в переводчик. Подробнее смотрите в "Режимы перевода".                                                                                                                                                                                                                                                                                                                                                                                                                                               | `'raw'`<br>`'optimal'`<br>`'deepl_mustache'`<br>                     |
| `'translator_source_lang'`          | `str` или `False` | Что передать, как язык оригинального текста:<br><br>`False` - выбрать язык из xml-файла.<br><br>`'auto'` - автоматическое определение переводчиком (только для `GoogleTranslator`)                                                                                                                                                                                                                                                                                                                                                 | `False`<br>`'Auto'`                                                  |
| `'translator_model'`                | `str`             | Модель для перевода, которую нужно указать в запросе <br><br>(если используется `'translator'` от `OpenAI` или другой API для LLM)                                                                                                                                                                                                                                                                                                                                                                                                 | `gpt-4o-mini`                                                        |
| `'translator_settings'`             | `dict`            | Настройки для модели API LLM или другого провайдера. <br><br>Настройки передаются в `LLMClient.py`, обработка настроек зависит от используемого API.                                                                                                                                                                                                                                                                                                                                                                               | `{}`                                                                 |
| `'translator_debug'`                | `bool`            | Вывод отладочных сообщений <br><br>(Показывает строки, которые отправляются в переводчик)                                                                                                                                                                                                                                                                                                                                                                                                                                          | `True`<br>`False`                                                    |
| `'translate_comments'`              | `bool`            | Нужно ли переводить комментарии `.xml` файлов?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `True`<br>`False`                                                    |
| `'force_overwrite_loc2'`            | `bool`            | Нужно ли перезаписать все файлы `.loc2` в папке `localization`?<br><br>`True` - Перезаписать все файлы `.loc2`.<br>`False` - Перезаписать только файлы, на которые был сделан перевод (`target_languages`).                                                                                                                                                                                                                                                                                                                        | `True`<br>`False`                                                    |
| `'use_language_detector'`           | `bool`            | Использовать ли детектор языка для каждой строки переданной в переводчик?<br><br>Полезно, если строки внутри language-тегов в xml-файле написаны на разных языках (неполный перевод).<br><br>Используется для `GoogleTranslator` и `DeeplTranslator`.<br><br>Требует ключ API для работы.                                                                                                                                                                                                                                          | `True`<br>`False`                                                    |
| `'language_detector_api_key'`       | `str`             | Api-ключ для детектора языка.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |                                                                      |

# Режимы перевода
Оригинал строк для примера форматирования: 
1. `{colour_start|guard} Guard {colour_end}`
2. `On Attack: Add 3~6 true Dmg and {colour_start|elaina_purpledawn} steal {colour_end} 25%%Spd from target`

| Режим              | Описание и особенности                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Текст, который подаётся в переводчик                                                                                                                             |
| ------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `'raw'`            | Строка подаётся "как есть", без изменений.                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | `{colour_start\|guard} Guard {colour_end}`<br><br>`On Attack: Add 3~6 true Dmg and {colour_start\|elaina_purpledawn} steal {colour_end} 25%%Spd from target`<br> |
| `'optimal'`        | Делит строки на части между "непереводимыми структурами".<br>После перевода собирает строку заново, оставляя непереводимые структуры.<br><br>Подходит для переводчиков, которые могут заменить/перевести/пропустить нужные нам в оригинальном варианте части строки.<br><br>Самый экономный способ перевода по количеству символов для перевода.                                                                                                                                                                      | `Guard`<br><br>`On Attack: Add 3~6 true Dmg and`<br><br>`steal`<br><br>`25%%Spd from target`                                                                     |
| `'deepl_mustache'` | Заменяет части текста, которые не нужно переводить на уникальные идентификаторы, после чего передаёт строку в переводчик. <br><br>После получения перевода заменяет идентификаторы обратно.<br><br>Изначально, этот режим был добавлен для переводчика DeepL, так как он поддерживает такие структуры (не будет их переводить).<br><br>Если планируете переводить текст, используя этот режим, то стоит удостовериться, что переводчик не искажает и не исключает уникальные идентификаторы, при формировании ответа. | `<m id=1/> Guard <m id=2/>`<br><br>`On Attack: Add 3~6 true Dmg and <m id=1/> steal <m id=2/> 25%%Spd from target`                                               |
# Переводчики
Ниже представлена таблица с сравнениями нескольких переводчиков (которые я тестировал), а также таблица поддерживаемых языков.

| Переводчик         | Лучший режим форматирования                                                                        | Оценка качества перевода и особенности                                                                                                                                                                                                                | Цена                                                                                                                                                              | Требует API ключ |
| ------------------ | -------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| `GoogleTranslator` | Лучше всего использовать `optimal`. <br><br>`raw` и `deepl_mustache` показывают плохие результаты. | Низкое, зато быстро и  бесплатно. <br><br>Подходит для рофло-переводов, или просто, чтобы хоть что-то было вместо голубых надписей.<br><br>Если текст не сильно сложный, то и так сойдёт.<br><br>Имеет режим `auto`, для определения исходного языка. | Бесплатно                                                                                                                                                         | ❌ Нет            |
| `DeeplTranslator`  | Лучше всего использовать либо `deepl_mustache`, либо `optimal` (для экономии).                     | Среднее/высокое.                                                                                                                                                                                                                                      | **Бесплатно:** 500 000 символов в месяц.<br><br>С подпиской Pro 25,00$ за 1 000 000 символов.<br><br>[Тарифы](https://www.deepl.com/en/pro/change-plan#developer) | ✔️ Да            |
| `DeepSeek-R1`      | `deepl_mustache` с промтом подходящий под тип форматирования.                                      | Высокое/среднее.                                                                                                                                                                                                                                      | *Зависит от провайдера.*                                                                                                                                          | ✔️ Да            |
| `gpt-4o-mini`      | *Зависит от промта.* Для лучшего перевода -`deepl_mustache`.                                       | Высокое/среднее.<br><br>*API не работает в России.*                                                                                                                                                                                                     | *Зависит от провайдера.*                                                                                                                                          | ✔️ Да            |
| Другие LLM         | *Зависит от промта.*                                                                               | *Зависит от модели.*<br><br>Можно настроить обработку под конкретного провайдера в `LLMClient.py`.                                                                                                                                                    | *Зависит от провайдера.*<br><br>При желании и возможностях можно развернуть модели локально, что позволит делать перевод бесплатно.                               | ❓*Возможно*      |

| Переводчик         | Поддерживаемые языки                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `GoogleTranslator` | `['afrikaans', 'albanian', 'amharic', 'arabic', 'armenian', 'assamese', 'aymara', 'azerbaijani', 'bambara', 'basque', 'belarusian', 'bengali', 'bhojpuri', 'bosnian', 'bulgarian', 'catalan', 'cebuano', 'chichewa', 'chinese (simplified)', 'chinese (traditional)', 'corsican', 'croatian', 'czech', 'danish', 'dhivehi', 'dogri', 'dutch', 'english', 'esperanto', 'estonian', 'ewe', 'filipino', 'finnish', 'french', 'frisian', 'galician', 'georgian', 'german', 'greek', 'guarani', 'gujarati', 'haitian creole', 'hausa', 'hawaiian', 'hebrew', 'hindi', 'hmong', 'hungarian', 'icelandic', 'igbo', 'ilocano', 'indonesian', 'irish', 'italian', 'japanese', 'javanese', 'kannada', 'kazakh', 'khmer', 'kinyarwanda', 'konkani', 'korean', 'krio', 'kurdish (kurmanji)', 'kurdish (sorani)', 'kyrgyz', 'lao', 'latin', 'latvian', 'lingala', 'lithuanian', 'luganda', 'luxembourgish', 'macedonian', 'maithili', 'malagasy', 'malay', 'malayalam', 'maltese', 'maori', 'marathi', 'meiteilon (manipuri)', 'mizo', 'mongolian', 'myanmar', 'nepali', 'norwegian', 'odia (oriya)', 'oromo', 'pashto', 'persian', 'polish', 'portuguese', 'punjabi', 'quechua', 'romanian', 'russian', 'samoan', 'sanskrit', 'scots gaelic', 'sepedi', 'serbian', 'sesotho', 'shona', 'sindhi', 'sinhala', 'slovak', 'slovenian', 'somali', 'spanish', 'sundanese', 'swahili', 'swedish', 'tajik', 'tamil', 'tatar', 'telugu', 'thai', 'tigrinya', 'tsonga', 'turkish', 'turkmen', 'twi', 'ukrainian', 'urdu', 'uyghur', 'uzbek', 'vietnamese', 'welsh', 'xhosa', 'yiddish', 'yoruba', 'zulu']` |
| `DeeplTranslator`  | `['bulgarian', 'czech', 'danish', 'german', 'greek', 'english', 'spanish', 'estonian', 'finnish', 'french', 'hungarian', 'indonesian', 'italian', 'japanese', 'lithuanian', 'latvian', 'dutch', 'polish', 'portuguese', 'romanian', 'russian', 'slovak', 'slovenian', 'swedish', 'turkish', 'ukrainian', 'chinese']`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `LLM`              | *В зависимости от модели.*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |

# Языковые  детекторы

Для чего нужен языковой детектор? 
Предположим у нас есть мод, который на половину переведён. Тогда в файле `.xml` есть строки двух или более языков (в худшем случаи). 

В каждом запросе к переводчику мы указываем язык текста, и язык на который нужно перевести текст. И когда мы подаём неправильный язык исходного текста, то переводчик не может перевести переданный текст.

Для того, чтобы передавать правильный язык оригинального текста, можно детектить язык для каждой строки, передаваемой в переводчик.

В случаи с `DeeplTranslater` у которого нет режима автоматического распознания языка по API, это может положительно повлиять на качество перевода.

| Языковой детектор                                 | Оценка качества                                                                                                                                                                                                                                                                   | Цена                                                                                                                                              | Требует API ключ |
| ------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------- |
| [detectlanguage.com](https://detectlanguage.com/) | Небольшие по количеству символов строки может определять не совсем правильно. Также может путать японский с китайским, а вместо английского выдать другой язык.<br>Лучше чем нечего для `DeepL`, но может потребоваться дополнительная обработка неправильно распознанных языков. | Бесплатный тариф:<br>1,000 запросов/день  <br>1 MB/день<br><br>[Есть другие платные тарифы.](https://detectlanguage.com/private/plan_changes/new) | ✔️ Да            |

# Поддерживаемые игрой языки 
Примерный список поддерживаемых игрой языков:
`['brazilian','czech','english','french','german','italian','japanese','koreana','koreanb','polish','russian','schinese','spanish','tchinese']`

Возможно это не полный список, и если уверены, что язык поддерживается игрой, можете попробовать его использовать.